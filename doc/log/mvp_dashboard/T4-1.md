# T4-1: Fix Celery task error handling

**Status:** Fix applied
**Date:** 2026-02-20

## Problem
`generate_synthetic_discussion()` in `tasks.py` had a broad `except Exception` that caught all errors and returned `{"success": False, "error": str(e)}`. This made Celery see the task as SUCCESS (it returned a value), preventing auto-retry for transient LLM errors and hiding failures from monitoring.

## Fix
1. Removed the `try/except Exception` block entirely. Exceptions now propagate:
   - `ClientError`, `PermissionDeniedError`, `RateLimitError` → auto-retried by Celery (configured in `__init__.py:50-59`)
   - `ValueError` (persona not found) → Celery marks as FAILURE (not retryable)
   - Other exceptions → Celery marks as FAILURE
2. Updated `task_status()` in `synthetic.py` to check `result.failed()` before `result.ready()` and removed the dead `success: False` branch.

## Files Changed
- `btcopilot/btcopilot/training/tasks.py:90-157` — removed try/except
- `btcopilot/btcopilot/training/routes/synthetic.py:140-171` — reordered failed/ready checks
